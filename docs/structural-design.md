### 1. **界面设计图**

#### 主界面设计：

- **标题栏**：显示当前日期、时间，以及一个返回按钮和设置按钮。

- 日记显示区

  ：

  - 以卡片形式展示已记录的日记，每个卡片显示日期、标题和部分内容。
  - 顶部有一个 “新增日记” 按钮，点击后进入编辑页面。
  - 滚动查看历史日记，可以通过日期快速筛选。

- **搜索栏**：在顶部有一个搜索框，可以通过关键词搜索之前的日记。

- **日历视图**：提供一个月历视图，可以快速跳转到某一天查看或新增日记。

#### 日记编辑界面：

- **标题输入框**：输入日记的标题。
- **内容编辑框**：可支持富文本格式，如加粗、斜体、列表等。
- **标签选择**：用户可以为日记添加标签（工作、生活、学习等）。
- **保存按钮**：保存日记并返回主界面。
- **删除按钮**：删除当前日记。

#### 设置界面：

- 用户可以配置同步选项、密码保护、云存储服务、日记导出选项等。

### 2. **详细架构设计**

#### 2.1 **架构概览**

- 前端（UI层）

  ：

  - 负责与用户交互的所有功能，基于 UWP（Universal Windows Platform）构建。
  - 使用 MVVM (Model-View-ViewModel) 架构来分离逻辑和界面，确保代码的可维护性和可测试性。

- 业务逻辑层（BLL）

  ：

  - 负责处理日记的创建、编辑、删除和搜索等功能。包括日记的加密、同步以及标签管理。

- 数据层（DAL）

  ：

  - 负责与数据库的交互，支持本地 SQLite 数据库以及云端数据库（如 Firebase）的同步。

- 服务层

  ：

  - 处理与外部服务的交互，如云存储、备份和同步。
  - 支持用户选择的同步服务（如 OneDrive、Google Drive、Firebase 等）。

#### 2.2 **模块划分**

1. **界面模块（UI）**：
   - 负责应用程序的用户界面，响应用户输入。
   - 基于 XAML 设计界面，通过 ViewModel 绑定数据。
2. **日记管理模块**：
   - 负责创建、编辑、删除日记记录，并为其添加标签、时间戳等元数据。
   - 提供日记的本地存储、加密存储以及多终端同步功能。
3. **搜索与过滤模块**：
   - 允许用户通过关键词、日期、标签等方式进行搜索和筛选日记。
4. **同步与备份模块**：
   - 支持用户将日记备份到云端，并在不同设备上同步。
5. **设置模块**：
   - 允许用户配置密码保护、主题设置、导出数据等。
6. **日志模块**：
   - 用于记录应用运行过程中的错误和异常，便于调试和维护。

### 3. **数据库设计**

#### 数据库：SQLite

##### **数据表：Diary**

| 字段名       | 数据类型 | 描述                       |
| ------------ | -------- | -------------------------- |
| Id           | INTEGER  | 主键，自增                 |
| Title        | TEXT     | 日记标题                   |
| Content      | TEXT     | 日记内容                   |
| Tags         | TEXT     | 标签，逗号分隔             |
| CreatedDate  | DATETIME | 创建时间                   |
| ModifiedDate | DATETIME | 最后修改时间               |
| IsEncrypted  | BOOLEAN  | 是否加密存储               |
| SyncStatus   | INTEGER  | 同步状态（未同步、已同步） |

##### **数据表：Settings**

| 字段名       | 数据类型 | 描述       |
| ------------ | -------- | ---------- |
| Id           | INTEGER  | 主键，自增 |
| SettingKey   | TEXT     | 设置项的键 |
| SettingValue | TEXT     | 设置项的值 |

##### **数据表：User**

| 字段名    | 数据类型 | 描述               |
| --------- | -------- | ------------------ |
| Id        | INTEGER  | 主键，自增         |
| Username  | TEXT     | 用户名             |
| Password  | TEXT     | 用户密码，加密存储 |
| CloudSync | BOOLEAN  | 是否启用云同步     |
| LastSync  | DATETIME | 上次同步时间       |

### 4. **详细功能描述**

- **日记管理**：用户可以创建、编辑、删除日记。每篇日记可以选择是否加密，加密的日记需要输入密码才能查看。
- **搜索功能**：用户可以按关键词、日期、标签等条件筛选和搜索日记。
- **标签管理**：用户可以为每篇日记添加多个标签，便于日后的分类查找。
- **同步与备份**：应用提供本地存储和云端同步选项，用户可以选择手动或自动将日记同步到云端。支持常见的云服务如 OneDrive、Google Drive 或自定义服务器。
- **安全与隐私**：支持为日记设置密码保护，同时可以配置自动锁定时间，以保护隐私。

### 5. **同步设计**

通过定期或用户触发的同步功能，应用将本地的日记数据与云端同步。支持的同步方式有：

- **本地与云端双向同步**：当本地与云端的日记发生变化时，系统自动更新最新数据。
- **冲突解决机制**：当用户在不同设备上修改同一篇日记时，应用会提示用户选择保留的版本，或者自动合并内容。

### 6. **技术栈**

- **前端**：C#、XAML (UWP)
- **数据库**：SQLite（本地存储）、Firebase（云端同步）
- **加密**：AES 对称加密用于加密日记内容
- **API**：RESTful API 用于实现云端同步